{"ast":null,"code":"import{useLocation,useNavigate}from\"react-router-dom\";import{useState,useEffect}from\"react\";import axios from\"axios\";import{ShoppingCart}from\"lucide-react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CheckoutPage=()=>{var _location$state,_location$state2,_location$state3;const location=useLocation();const navigate=useNavigate();const cartItems=((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.cartItems)||[];const subtotal=((_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.total)||0;const finalAmount=((_location$state3=location.state)===null||_location$state3===void 0?void 0:_location$state3.finalAmount)||subtotal;// Use final amount directly\nconst[address,setAddress]=useState(\"\");const[addressError,setAddressError]=useState(\"\");// New state for address validation\nconst[loading,setLoading]=useState(true);const[error,setError]=useState(\"\");const[user,setUser]=useState();const[discountCode,setDiscountCode]=useState(\"\");const[discountAmount,setDiscountAmount]=useState(0);const[discountMessage,setDiscountMessage]=useState(\"\");const finalPayable=finalAmount-discountAmount||finalAmount;const[dCode,setDCode]=useState(\"\");console.log(\"received cartItems: \",cartItems);useEffect(()=>{const fetchUserProfile=async()=>{try{const token=localStorage.getItem(\"userToken\");if(!token)return navigate(\"/login\");const{data}=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/users/profile\"),{headers:{Authorization:\"Bearer \".concat(token)}});setUser(data);setAddress(data.address||\"\");}catch(error){setError(\"Failed to fetch user profile.\");}finally{setLoading(false);console.log(loading);console.log(error);}};fetchUserProfile();},[navigate]);// Address validation function\nconst validateAddress=input=>{// Blocked words (you can add more)\nconst blockedWords=[\"fake\",\"test\",\"unknown\",\"n/a\",\"123\",\"####\"];// Regex to allow letters, numbers, spaces, commas, and common symbols\nconst validAddressPattern=/^[a-zA-Z0-9\\s,.-]+$/;if(input.length<10){setAddressError(\"Address must be at least 10 characters long.\");return false;}if(!validAddressPattern.test(input)){setAddressError(\"Address contains invalid characters.\");return false;}if(blockedWords.some(word=>input.toLowerCase().includes(word))){setAddressError(\"This address is not valid for shipping.\");return false;}setAddressError(\"\");// Clear error if valid\nreturn true;};const handleAddressChange=e=>{const newAddress=e.target.value;setAddress(newAddress);validateAddress(newAddress);// Validate on change\n};const applyDiscount=async()=>{console.log(\"Applying Discount:\",discountCode,subtotal);// Debug Log\ntry{const{data}=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/discounts/apply\"),{code:discountCode,totalAmount:subtotal});console.log(\"Response:\",data);// ✅ Check if response comes back\nsetDiscountAmount(data.discountAmount);setDCode(data.discountCode);console.log(\"fetched data.code\",data.discountCode,\"dCode: \",dCode);setDiscountMessage(\"Discount applied successfully!\");hideMessage();}catch(error){var _error$response,_error$response2,_error$response2$data;console.error(\"Discount Error:\",((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data)||error.message);setDiscountMessage(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||\"Invalid discount code.\");hideMessage();}};const handlePayment=async(cartItems,finalPayable,user)=>{// console.log(\"🚀 handlePayment called!\");\nconsole.log(\"🔹 cartItems:\",cartItems);// console.log(\"🔹 finalAmount:\", finalPayable);\n// console.log(\"🔹 user:\", user);\nif(!user||!user._id){console.error(\"❌ User is missing or invalid! Make sure you are logged in.\");alert(\"❌ User data is missing. Please log in again.\");return;}try{const token=localStorage.getItem(\"userToken\");if(!token){console.error(\"❌ Authentication error: Token is missing.\");alert(\"❌ Authentication error: Please log in.\");return;}const amountInPaise=Math.round(finalPayable*100);const loadRazorpayScript=()=>new Promise(resolve=>{if(document.getElementById(\"razorpay-script\")){resolve(true);return;}const script=document.createElement(\"script\");script.id=\"razorpay-script\";script.src=\"https://checkout.razorpay.com/v1/checkout.js\";script.onload=()=>resolve(true);script.onerror=()=>resolve(false);document.body.appendChild(script);});const scriptLoaded=await loadRazorpayScript();if(!scriptLoaded){console.error(\"❌ Failed to load Razorpay.\");alert(\"❌ Failed to load Razorpay. Please try again.\");return;}if(typeof window.Razorpay===\"undefined\"){console.error(\"❌ Razorpay not available.\");alert(\"❌ Razorpay not available. Try again later.\");return;}const options={key:\"rzp_test_1DP5mmOlF5G5ag\",amount:amountInPaise,currency:\"INR\",name:\"ShopEase\",description:\"Order Payment\",handler:async function(response){console.log(\"✅ Payment successful! Payment ID:\",response.razorpay_payment_id);alert(\"✅ Payment successful!\");const orderData={user:user._id,items:cartItems.map(item=>({product:item.product._id||item._id,name:item.name,quantity:item.quantity||1,price:item.price})),totalAmount:finalPayable,paymentId:response.razorpay_payment_id,discountCode:dCode||\"NO_DISCOUNT\",// ✅ Ensure discount is applied\npaymentStatus:\"Paid\"};console.log(\"🔹 Sending Order Request:\",orderData);try{const res=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/store-after-payment\"),orderData,{headers:{Authorization:\"Bearer \".concat(token),\"Content-Type\":\"application/json\"}});console.log(\"✅ Order stored successfully:\",res.data);alert(\"✅ Order placed successfully!\");try{if(!user||!user._id){console.error(\"❌ No valid user found.\");alert(\"User not found!\");return;}// let userId = user._id;\n// console.log(\"User in cart try block: \", userId);\n// console.log(\"🛒 Sending request to clear cart for user:\", userId);\nawait axios.delete(\"\".concat(process.env.REACT_APP_API_URL,\"/api/cart/clear/\").concat(user._id),{headers:{Authorization:\"Bearer \".concat(token),\"Content-Type\":\"application/json\"}});console.log(\"✅ Cart cleared successfully:\",response.data);alert(\"✅ Items removed from cart!\");navigate(\"/order-history\");}catch(error){var _error$response3,_error$response3$data;console.error(\"❌ Error clearing cart:\",error);alert(\"\\u26A0\\uFE0F Error: \".concat(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||\"Cart was not cleared.\"));}}catch(error){var _error$response4,_error$response4$data;console.error(\"❌ Error storing order:\",error);alert(\"❌ Error storing order: \"+(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.message)||error.message));}},prefill:{name:(user===null||user===void 0?void 0:user.name)||\"Test User\",email:(user===null||user===void 0?void 0:user.email)||\"test@example.com\"},theme:{color:\"#3399cc\"},modal:{ondismiss:async function(){console.log(\"❌ Payment was closed by the user.\");alert(\"❌ Payment was not completed. Storing as unpaid order.\");const unpaidOrderData={user:user._id,items:cartItems.map(item=>({product:item.productId||item._id,name:item.name,quantity:item.quantity||1,price:item.price})),totalAmount:finalPayable,paymentId:null,paymentStatus:\"Unpaid\"};console.log(\"🔹 Storing Unpaid Order:\",unpaidOrderData);try{const res=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/store-after-payment\"),unpaidOrderData,{headers:{Authorization:\"Bearer \".concat(token),\"Content-Type\":\"application/json\"}});console.log(\"✅ Unpaid order stored successfully:\",res.data);alert(\"✅ Unpaid order has been stored.\");}catch(error){var _error$response5,_error$response6,_error$response6$data;console.error(\"❌ Error storing unpaid order:\",((_error$response5=error.response)===null||_error$response5===void 0?void 0:_error$response5.data)||error.message);alert(\"❌ Error storing unpaid order: \"+(((_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.message)||error.message));}}}};const rzp=new window.Razorpay(options);rzp.open();}catch(error){console.error(\"❌ Unexpected Error:\",error);alert(\"❌ Unexpected error occurred.\");}};const hideMessage=()=>{setTimeout(()=>{setDiscountMessage(\"\");},3000);};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-6xl mx-auto p-6 mt-[60px] relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute -top-32 left-1/4 w-96 h-96 bg-gradient-to-br from-[#B76E79]/10 to-[#C5A880]/10 rounded-full blur-3xl\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/90 backdrop-blur-sm rounded-3xl shadow-xl border border-[#E0D6CC]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-8 border-b border-[#E0D6CC]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-[#B76E79]/10 rounded-lg\",children:/*#__PURE__*/_jsx(ShoppingCart,{className:\"w-8 h-8 text-[#B76E79]\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-serif text-[#6B4E4D]\",children:\"Complete Your Purchase\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid lg:grid-cols-[2fr_1fr] gap-8 p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:cartItems.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-6 p-4 bg-[#FAF6F0] rounded-xl border border-[#E0D6CC]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 rounded-lg overflow-hidden\",children:/*#__PURE__*/_jsx(\"img\",{src:item.product.images[0],className:\"w-full h-full object-cover\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-serif text-[#6B4E4D]\",children:item.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-[#B76E79]\",children:[\"\\u20B9\",item.price.toFixed(2)]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-[#6B4E4D]/80\",children:[\"x\",item.quantity]})]})]})]},item.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#FAF6F0] rounded-xl p-6 border border-[#E0D6CC]\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"flex-1 bg-white border border-[#E0D6CC] rounded-lg px-4 py-3 text-[#6B4E4D] placeholder-[#B76E79]/50\",placeholder:\"Enter promo code\",value:discountCode,onChange:e=>setDiscountCode(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:applyDiscount,className:\"px-6 py-3 bg-[#B76E79]/10 text-[#B76E79] rounded-lg hover:bg-[#B76E79]/20 transition-colors\",children:\"Apply\"})]}),discountMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-3 text-sm \".concat(discountMessage.includes('Applied')?'text-[#C5A880]':'text-[#B76E79]'),children:discountMessage})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#FAF6F0] rounded-xl p-6 border border-[#E0D6CC]\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-serif text-[#6B4E4D] mb-4\",children:\"Shipping Details\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"w-full bg-white border border-[#E0D6CC] rounded-lg px-4 py-3 text-[#6B4E4D] min-h-[120px]\",value:address,onChange:handleAddressChange,placeholder:\"Enter shipping address...\"}),addressError&&/*#__PURE__*/_jsx(\"p\",{className:\"text-[#B76E79] mt-2 text-sm\",children:addressError})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-[#FAF6F0] rounded-xl p-6 border border-[#E0D6CC] h-fit sticky top-24\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center pb-4 border-b border-[#E0D6CC]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[#6B4E4D]\",children:\"Subtotal\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-[#B76E79]\",children:[\"\\u20B9\",subtotal.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center pb-4 border-b border-[#E0D6CC]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[#6B4E4D]\",children:\"Discount\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-[#B76E79]\",children:[\"-\\u20B9\",discountAmount.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center pb-4 border-b border-[#E0D6CC]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[#6B4E4D]\",children:\"Shipping\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-[#C5A880]\",children:\"FREE\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center pt-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg font-serif text-[#6B4E4D]\",children:\"Total\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xl font-bold text-[#B76E79]\",children:[\"\\u20B9\",finalPayable.toFixed(2)]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePayment(cartItems,finalPayable,user),className:\"w-full py-4 mt-6 rounded-xl font-medium transition-all \".concat(cartItems.length===0?\"bg-gray-200 text-gray-400 cursor-not-allowed\":\"bg-[#B76E79] hover:bg-[#C5A880] text-white hover:shadow-lg\"),disabled:cartItems.length===0,children:cartItems.length>0?'Proceed to Payment':'Cart Empty'})]})})]})]})]});};export default CheckoutPage;","map":{"version":3,"names":["useLocation","useNavigate","useState","useEffect","axios","ShoppingCart","jsx","_jsx","jsxs","_jsxs","CheckoutPage","_location$state","_location$state2","_location$state3","location","navigate","cartItems","state","subtotal","total","finalAmount","address","setAddress","addressError","setAddressError","loading","setLoading","error","setError","user","setUser","discountCode","setDiscountCode","discountAmount","setDiscountAmount","discountMessage","setDiscountMessage","finalPayable","dCode","setDCode","console","log","fetchUserProfile","token","localStorage","getItem","data","get","concat","process","env","REACT_APP_API_URL","headers","Authorization","validateAddress","input","blockedWords","validAddressPattern","length","test","some","word","toLowerCase","includes","handleAddressChange","e","newAddress","target","value","applyDiscount","post","code","totalAmount","hideMessage","_error$response","_error$response2","_error$response2$data","response","message","handlePayment","_id","alert","amountInPaise","Math","round","loadRazorpayScript","Promise","resolve","document","getElementById","script","createElement","id","src","onload","onerror","body","appendChild","scriptLoaded","window","Razorpay","options","key","amount","currency","name","description","handler","razorpay_payment_id","orderData","items","map","item","product","quantity","price","paymentId","paymentStatus","res","delete","_error$response3","_error$response3$data","_error$response4","_error$response4$data","prefill","email","theme","color","modal","ondismiss","unpaidOrderData","productId","_error$response5","_error$response6","_error$response6$data","rzp","open","setTimeout","className","children","images","toFixed","type","placeholder","onChange","onClick","disabled"],"sources":["E:/projects/web/my-app/Frontend/src/pages/CheckoutPage.js"],"sourcesContent":["import { useLocation, useNavigate } from \"react-router-dom\";\r\nimport { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { ShoppingCart } from \"lucide-react\";\r\n\r\nconst CheckoutPage = () => {\r\n        const location = useLocation();\r\n        const navigate = useNavigate();\r\n\r\n        const cartItems = location.state?.cartItems || [];\r\n        const subtotal = location.state?.total || 0;\r\n        const finalAmount = location.state?.finalAmount || subtotal; // Use final amount directly\r\n\r\n        const [address, setAddress] = useState(\"\");\r\n        const [addressError, setAddressError] = useState(\"\"); // New state for address validation\r\n        const [loading, setLoading] = useState(true);\r\n        const [error, setError] = useState(\"\");\r\n        const [user, setUser] = useState();\r\n        const [discountCode, setDiscountCode] = useState(\"\");\r\n        const [discountAmount, setDiscountAmount] = useState(0);\r\n        const [discountMessage, setDiscountMessage] = useState(\"\");\r\n\r\n        const finalPayable = finalAmount - discountAmount || finalAmount;\r\n        const [dCode, setDCode] = useState(\"\");\r\n\r\n        console.log(\"received cartItems: \", cartItems);\r\n\r\n        useEffect(() => {\r\n                const fetchUserProfile = async () => {\r\n                        try {\r\n                                const token = localStorage.getItem(\"userToken\");\r\n                                if (!token) return navigate(\"/login\");\r\n\r\n                                const { data } = await axios.get(`${process.env.REACT_APP_API_URL}/api/users/profile`, {\r\n                                        headers: { Authorization: `Bearer ${token}` },\r\n                                });\r\n                                setUser(data);\r\n                                setAddress(data.address || \"\");\r\n                        } catch (error) {\r\n                                setError(\"Failed to fetch user profile.\");\r\n                        } finally {\r\n                                setLoading(false);\r\n                                console.log(loading);\r\n                                console.log(error);\r\n                        }\r\n                };\r\n                fetchUserProfile();\r\n        }, [navigate]);\r\n\r\n        // Address validation function\r\n        const validateAddress = (input) => {\r\n                // Blocked words (you can add more)\r\n                const blockedWords = [\"fake\", \"test\", \"unknown\", \"n/a\", \"123\", \"####\"];\r\n\r\n                // Regex to allow letters, numbers, spaces, commas, and common symbols\r\n                const validAddressPattern = /^[a-zA-Z0-9\\s,.-]+$/;\r\n\r\n                if (input.length < 10) {\r\n                        setAddressError(\"Address must be at least 10 characters long.\");\r\n                        return false;\r\n                }\r\n\r\n                if (!validAddressPattern.test(input)) {\r\n                        setAddressError(\"Address contains invalid characters.\");\r\n                        return false;\r\n                }\r\n\r\n                if (blockedWords.some((word) => input.toLowerCase().includes(word))) {\r\n                        setAddressError(\"This address is not valid for shipping.\");\r\n                        return false;\r\n                }\r\n\r\n                setAddressError(\"\"); // Clear error if valid\r\n                return true;\r\n        };\r\n\r\n        const handleAddressChange = (e) => {\r\n                const newAddress = e.target.value;\r\n                setAddress(newAddress);\r\n                validateAddress(newAddress); // Validate on change\r\n        };\r\n\r\n        const applyDiscount = async () => {\r\n                console.log(\"Applying Discount:\", discountCode, subtotal); // Debug Log\r\n\r\n                try {\r\n                        const { data } = await axios.post(`${process.env.REACT_APP_API_URL}/api/discounts/apply`, {\r\n                                code: discountCode,\r\n                                totalAmount: subtotal,\r\n                        });\r\n\r\n                        console.log(\"Response:\", data); // ✅ Check if response comes back\r\n\r\n                        setDiscountAmount(data.discountAmount);\r\n                        setDCode(data.discountCode);\r\n                        console.log(\"fetched data.code\", data.discountCode, \"dCode: \", dCode);\r\n                        setDiscountMessage(\"Discount applied successfully!\");\r\n                        hideMessage();\r\n                } catch (error) {\r\n                        console.error(\"Discount Error:\", error.response?.data || error.message);\r\n                        setDiscountMessage(error.response?.data?.message || \"Invalid discount code.\");\r\n                        hideMessage();\r\n                }\r\n        };\r\n\r\n        const handlePayment = async (cartItems, finalPayable, user) => {\r\n                // console.log(\"🚀 handlePayment called!\");\r\n                console.log(\"🔹 cartItems:\", cartItems);\r\n                // console.log(\"🔹 finalAmount:\", finalPayable);\r\n                // console.log(\"🔹 user:\", user);\r\n\r\n                if (!user || !user._id) {\r\n                        console.error(\"❌ User is missing or invalid! Make sure you are logged in.\");\r\n                        alert(\"❌ User data is missing. Please log in again.\");\r\n                        return;\r\n                }\r\n\r\n                try {\r\n                        const token = localStorage.getItem(\"userToken\");\r\n                        if (!token) {\r\n                                console.error(\"❌ Authentication error: Token is missing.\");\r\n                                alert(\"❌ Authentication error: Please log in.\");\r\n                                return;\r\n                        }\r\n\r\n                        const amountInPaise = Math.round(finalPayable * 100);\r\n\r\n                        const loadRazorpayScript = () =>\r\n                                new Promise((resolve) => {\r\n                                        if (document.getElementById(\"razorpay-script\")) {\r\n                                                resolve(true);\r\n                                                return;\r\n                                        }\r\n                                        const script = document.createElement(\"script\");\r\n                                        script.id = \"razorpay-script\";\r\n                                        script.src = \"https://checkout.razorpay.com/v1/checkout.js\";\r\n                                        script.onload = () => resolve(true);\r\n                                        script.onerror = () => resolve(false);\r\n                                        document.body.appendChild(script);\r\n                                });\r\n\r\n                        const scriptLoaded = await loadRazorpayScript();\r\n                        if (!scriptLoaded) {\r\n                                console.error(\"❌ Failed to load Razorpay.\");\r\n                                alert(\"❌ Failed to load Razorpay. Please try again.\");\r\n                                return;\r\n                        }\r\n\r\n                        if (typeof window.Razorpay === \"undefined\") {\r\n                                console.error(\"❌ Razorpay not available.\");\r\n                                alert(\"❌ Razorpay not available. Try again later.\");\r\n                                return;\r\n                        }\r\n\r\n                        const options = {\r\n                                key: \"rzp_test_1DP5mmOlF5G5ag\",\r\n                                amount: amountInPaise,\r\n                                currency: \"INR\",\r\n                                name: \"ShopEase\",\r\n                                description: \"Order Payment\",\r\n                                handler: async function (response) {\r\n                                        console.log(\"✅ Payment successful! Payment ID:\", response.razorpay_payment_id);\r\n                                        alert(\"✅ Payment successful!\");\r\n\r\n                                        const orderData = {\r\n                                                user: user._id,\r\n                                                items: cartItems.map((item) => ({\r\n                                                        product: item.product._id || item._id,\r\n                                                        name: item.name,\r\n                                                        quantity: item.quantity || 1,\r\n                                                        price: item.price,\r\n                                                })),\r\n                                                totalAmount: finalPayable,\r\n                                                paymentId: response.razorpay_payment_id,\r\n                                                discountCode: dCode || \"NO_DISCOUNT\", // ✅ Ensure discount is applied\r\n                                                paymentStatus: \"Paid\",\r\n                                        };\r\n\r\n                                        console.log(\"🔹 Sending Order Request:\", orderData);\r\n\r\n                                        try {\r\n                                                const res = await axios.post(\r\n                                                        `${process.env.REACT_APP_API_URL}/api/orders/store-after-payment`,\r\n                                                        orderData,\r\n                                                        {\r\n                                                                headers: {\r\n                                                                        Authorization: `Bearer ${token}`,\r\n                                                                        \"Content-Type\": \"application/json\",\r\n                                                                },\r\n                                                        }\r\n                                                );\r\n\r\n                                                console.log(\"✅ Order stored successfully:\", res.data);\r\n                                                alert(\"✅ Order placed successfully!\");\r\n\r\n\r\n                                                try {\r\n                                                        if (!user || !user._id) {\r\n                                                                console.error(\"❌ No valid user found.\");\r\n                                                                alert(\"User not found!\");\r\n                                                                return;\r\n                                                        }\r\n\r\n                                                        // let userId = user._id;\r\n                                                        // console.log(\"User in cart try block: \", userId);\r\n                                                        // console.log(\"🛒 Sending request to clear cart for user:\", userId);\r\n\r\n                                                        await axios.delete(`${process.env.REACT_APP_API_URL}/api/cart/clear/${user._id}`, {\r\n                                                                headers: {\r\n                                                                        Authorization: `Bearer ${token}`,\r\n                                                                        \"Content-Type\": \"application/json\"\r\n                                                                }\r\n                                                        });\r\n\r\n                                                        console.log(\"✅ Cart cleared successfully:\", response.data);\r\n                                                        alert(\"✅ Items removed from cart!\");\r\n\r\n                                                        navigate(\"/order-history\");\r\n\r\n                                                } catch (error) {\r\n                                                        console.error(\"❌ Error clearing cart:\", error);\r\n                                                        alert(`⚠️ Error: ${error.response?.data?.message || \"Cart was not cleared.\"}`);\r\n                                                }\r\n\r\n\r\n                                        } catch (error) {\r\n                                                console.error(\"❌ Error storing order:\", error);\r\n                                                alert(\"❌ Error storing order: \" + (error.response?.data?.message || error.message));\r\n                                        }\r\n                                },\r\n                                prefill: {\r\n                                        name: user?.name || \"Test User\",\r\n                                        email: user?.email || \"test@example.com\",\r\n                                },\r\n                                theme: { color: \"#3399cc\" },\r\n\r\n                                modal: {\r\n                                        ondismiss: async function () {\r\n                                                console.log(\"❌ Payment was closed by the user.\");\r\n                                                alert(\"❌ Payment was not completed. Storing as unpaid order.\");\r\n\r\n                                                const unpaidOrderData = {\r\n                                                        user: user._id,\r\n                                                        items: cartItems.map((item) => ({\r\n                                                                product: item.productId || item._id,\r\n                                                                name: item.name,\r\n                                                                quantity: item.quantity || 1,\r\n                                                                price: item.price,\r\n                                                        })),\r\n                                                        totalAmount: finalPayable,\r\n                                                        paymentId: null,\r\n                                                        paymentStatus: \"Unpaid\",\r\n                                                };\r\n\r\n                                                console.log(\"🔹 Storing Unpaid Order:\", unpaidOrderData);\r\n\r\n                                                try {\r\n                                                        const res = await axios.post(\r\n                                                                `${process.env.REACT_APP_API_URL}/api/orders/store-after-payment`,\r\n                                                                unpaidOrderData,\r\n                                                                {\r\n                                                                        headers: {\r\n                                                                                Authorization: `Bearer ${token}`,\r\n                                                                                \"Content-Type\": \"application/json\",\r\n                                                                        },\r\n                                                                }\r\n                                                        );\r\n\r\n                                                        console.log(\"✅ Unpaid order stored successfully:\", res.data);\r\n                                                        alert(\"✅ Unpaid order has been stored.\");\r\n                                                } catch (error) {\r\n                                                        console.error(\"❌ Error storing unpaid order:\", error.response?.data || error.message);\r\n                                                        alert(\"❌ Error storing unpaid order: \" + (error.response?.data?.message || error.message));\r\n                                                }\r\n                                        },\r\n                                },\r\n                        };\r\n\r\n                        const rzp = new window.Razorpay(options);\r\n                        rzp.open();\r\n                } catch (error) {\r\n                        console.error(\"❌ Unexpected Error:\", error);\r\n                        alert(\"❌ Unexpected error occurred.\");\r\n                }\r\n        };\r\n\r\n        const hideMessage = () => {\r\n                setTimeout(() => {\r\n                        setDiscountMessage(\"\");\r\n                }, 3000);\r\n        };\r\n\r\n\r\n        return (\r\n                <div className=\"max-w-6xl mx-auto p-6 mt-[60px] relative\">\r\n                        {/* Background Elements */}\r\n                        <div className=\"absolute -top-32 left-1/4 w-96 h-96 bg-gradient-to-br from-[#B76E79]/10 to-[#C5A880]/10 rounded-full blur-3xl\" />\r\n\r\n                        {/* Main Card Container */}\r\n                        <div className=\"bg-white/90 backdrop-blur-sm rounded-3xl shadow-xl border border-[#E0D6CC]\">\r\n                                {/* Header Section */}\r\n                                <div className=\"p-8 border-b border-[#E0D6CC]\">\r\n                                        <div className=\"flex items-center gap-4\">\r\n                                                <div className=\"p-3 bg-[#B76E79]/10 rounded-lg\">\r\n                                                        <ShoppingCart className=\"w-8 h-8 text-[#B76E79]\" />\r\n                                                </div>\r\n                                                <h2 className=\"text-3xl font-serif text-[#6B4E4D]\">Complete Your Purchase</h2>\r\n                                        </div>\r\n                                </div>\r\n\r\n                                {/* Content Grid */}\r\n                                <div className=\"grid lg:grid-cols-[2fr_1fr] gap-8 p-8\">\r\n                                        {/* Left Column - Main Content */}\r\n                                        <div className=\"space-y-8\">\r\n                                                {/* Order Items */}\r\n                                                <div className=\"space-y-6\">\r\n                                                        {cartItems.map((item) => (\r\n                                                                <div key={item.id} className=\"flex items-center gap-6 p-4 bg-[#FAF6F0] rounded-xl border border-[#E0D6CC]\">\r\n                                                                        <div className=\"w-20 h-20 rounded-lg overflow-hidden\">\r\n                                                                                <img src={item.product.images[0]} className=\"w-full h-full object-cover\" />\r\n                                                                        </div>\r\n                                                                        <div className=\"flex-1\">\r\n                                                                                <h3 className=\"font-serif text-[#6B4E4D]\">{item.name}</h3>\r\n                                                                                <div className=\"flex items-center justify-between mt-2\">\r\n                                                                                        <span className=\"text-[#B76E79]\">₹{item.price.toFixed(2)}</span>\r\n                                                                                        <span className=\"text-[#6B4E4D]/80\">x{item.quantity}</span>\r\n                                                                                </div>\r\n                                                                        </div>\r\n                                                                </div>\r\n                                                        ))}\r\n                                                </div>\r\n\r\n                                                {/* Discount & Address Combined */}\r\n                                                <div className=\"space-y-8\">\r\n                                                        <div className=\"bg-[#FAF6F0] rounded-xl p-6 border border-[#E0D6CC]\">\r\n                                                                <div className=\"flex gap-4\">\r\n                                                                        <input\r\n                                                                                type=\"text\"\r\n                                                                                className=\"flex-1 bg-white border border-[#E0D6CC] rounded-lg px-4 py-3 text-[#6B4E4D] placeholder-[#B76E79]/50\"\r\n                                                                                placeholder=\"Enter promo code\"\r\n                                                                                value={discountCode}\r\n                                                                                onChange={(e) => setDiscountCode(e.target.value)}\r\n                                                                        />\r\n                                                                        <button\r\n                                                                                onClick={applyDiscount}\r\n                                                                                className=\"px-6 py-3 bg-[#B76E79]/10 text-[#B76E79] rounded-lg hover:bg-[#B76E79]/20 transition-colors\"\r\n                                                                        >\r\n                                                                                Apply\r\n                                                                        </button>\r\n                                                                </div>\r\n                                                                {discountMessage && (\r\n                                                                        <p className={`mt-3 text-sm ${discountMessage.includes('Applied') ? 'text-[#C5A880]' : 'text-[#B76E79]'}`}>\r\n                                                                                {discountMessage}\r\n                                                                        </p>\r\n                                                                )}\r\n                                                        </div>\r\n\r\n                                                        <div className=\"bg-[#FAF6F0] rounded-xl p-6 border border-[#E0D6CC]\">\r\n                                                                <h3 className=\"font-serif text-[#6B4E4D] mb-4\">Shipping Details</h3>\r\n                                                                <textarea\r\n                                                                        className=\"w-full bg-white border border-[#E0D6CC] rounded-lg px-4 py-3 text-[#6B4E4D] min-h-[120px]\"\r\n                                                                        value={address}\r\n                                                                        onChange={handleAddressChange}\r\n                                                                        placeholder=\"Enter shipping address...\"\r\n                                                                />\r\n                                                                {addressError && <p className=\"text-[#B76E79] mt-2 text-sm\">{addressError}</p>}\r\n                                                        </div>\r\n                                                </div>\r\n                                        </div>\r\n\r\n                                        {/* Right Column - Summary */}\r\n                                        <div className=\"bg-[#FAF6F0] rounded-xl p-6 border border-[#E0D6CC] h-fit sticky top-24\">\r\n                                                <div className=\"space-y-6\">\r\n                                                        <div className=\"flex justify-between items-center pb-4 border-b border-[#E0D6CC]\">\r\n                                                                <span className=\"text-[#6B4E4D]\">Subtotal</span>\r\n                                                                <span className=\"text-[#B76E79]\">₹{subtotal.toFixed(2)}</span>\r\n                                                        </div>\r\n\r\n                                                        <div className=\"flex justify-between items-center pb-4 border-b border-[#E0D6CC]\">\r\n                                                                <span className=\"text-[#6B4E4D]\">Discount</span>\r\n                                                                <span className=\"text-[#B76E79]\">-₹{discountAmount.toFixed(2)}</span>\r\n                                                        </div>\r\n\r\n                                                        <div className=\"flex justify-between items-center pb-4 border-b border-[#E0D6CC]\">\r\n                                                                <span className=\"text-[#6B4E4D]\">Shipping</span>\r\n                                                                <span className=\"text-[#C5A880]\">FREE</span>\r\n                                                        </div>\r\n\r\n                                                        <div className=\"flex justify-between items-center pt-4\">\r\n                                                                <span className=\"text-lg font-serif text-[#6B4E4D]\">Total</span>\r\n                                                                <span className=\"text-xl font-bold text-[#B76E79]\">₹{finalPayable.toFixed(2)}</span>\r\n                                                        </div>\r\n\r\n                                                        <button\r\n                                                                onClick={() => handlePayment(cartItems, finalPayable, user)}\r\n                                                                className={`w-full py-4 mt-6 rounded-xl font-medium transition-all ${cartItems.length === 0\r\n                                                                                ? \"bg-gray-200 text-gray-400 cursor-not-allowed\"\r\n                                                                                : \"bg-[#B76E79] hover:bg-[#C5A880] text-white hover:shadow-lg\"\r\n                                                                        }`}\r\n                                                                disabled={cartItems.length === 0}\r\n                                                        >\r\n                                                                {cartItems.length > 0 ? 'Proceed to Payment' : 'Cart Empty'}\r\n                                                        </button>\r\n                                                </div>\r\n                                        </div>\r\n                                </div>\r\n                        </div>\r\n                </div>\r\n        );\r\n};\r\n\r\n\r\nexport default CheckoutPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}